/*! For license information please see background.bundle.js.LICENSE.txt */
(()=>{"use strict";var e={2408:(e,t)=>{Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.iterator;var o={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},a=Object.assign,i={};function s(e,t,a){this.props=e,this.context=t,this.refs=i,this.updater=a||o}function r(){}function n(e,t,a){this.props=e,this.context=t,this.refs=i,this.updater=a||o}s.prototype.isReactComponent={},s.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},s.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},r.prototype=s.prototype;var l=n.prototype=new r;l.constructor=n,a(l,s.prototype),l.isPureReactComponent=!0;Array.isArray,Object.prototype.hasOwnProperty},7294:(e,t,o)=>{o(2408)}},t={};function o(a){var i=t[a];if(void 0!==i)return i.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,o),s.exports}(()=>{const e=JSON.parse('{"theme":{"class":"settings","id":"theme","label":"Menu theme","description":"Choose light or dark theme for the extension menus","value":"Light","type":"theme","options":["Light","Dark"],"pos":0},"unblockTimeout":{"class":"settings","id":"unblockTimeout","label":"Time-out button hold duration","description":"Number of seconds required when holding the unlock button","value":"20","type":"number","unit":"sec","min":3,"max":99,"step":1,"pos":1},"scheduleBlocking":{"class":"scheduling","id":"scheduleBlocking","label":"Allow scheduling","description":"Only block sites during certain days and hours","type":"switch","value":false,"pos":0},"activeDays":{"class":"scheduling","id":"activeDays","label":"Active days","description":"Days on which blocking will be active","type":"switchList","parentId":"scheduleBlocking","value":[{"label":"Monday","value":true},{"label":"Tuesday","value":true},{"label":"Wednesday","value":true},{"label":"Thursday","value":true},{"label":"Friday","value":true},{"label":"Saturday","value":false},{"label":"Sunday","value":false}],"pos":1},"activeTimes":{"class":"scheduling","id":"activeTimes","label":"Active times","description":"Times during which blocking will be active","type":"timeLimit","parentId":"scheduleBlocking","pos":2,"value":{"allDay":{"label":"All day","value":false},"start":{"label":"Start time","value":"09:00"},"end":{"label":"End time","value":"17:00"}}},"allowRevisits":{"class":"settings","id":"allowRevisits","label":"Allow re-visits after unblocking","description":"Allow multiple visits to sites that have been unblocked using the button within a certain time frame","type":"switch","pos":4,"value":true},"revisitLimit":{"class":"settings","id":"revisitLimit","label":"Re-visit time limit","description":"Time frame during which visits to blocked sites will be allowed after unblocking","value":3,"min":1,"max":100,"type":"number","unit":"min","pos":5,"parentId":"allowRevisits"},"isRated":{"value":false}}'),t=JSON.parse('[{"id":"pageBlock","title":"Time Out : Page Blocker","documentUrlPatterns":["https://*/*","http://*/*"]},{"id":"addDomainToBlockList","title":"Add this domain to block list","parentId":"pageBlock","visible":true},{"id":"addPageToBlockList","title":"Add this page to block list","parentId":"pageBlock","visible":true},{"id":"manageBlockList","title":"Manage block list","parentId":"pageBlock","visible":true}]'),a=e=>(e=e?.split("&")[0],"/"===e?.slice(-1)?e?.slice(0,-1):e),i=()=>"id"+Math.random().toString(16).slice(2),s=(e,t)=>{chrome.storage.sync.set(e,t)},r=(e,t)=>chrome.storage.sync.get(e,t),n=async e=>chrome.storage.sync.get(e),l={"allday-checkbox":!1,"end-time":"23:00",fri:!0,matches:"www.youtube.com\nwww.theguardian.com/uk\nwww.bbc.co.uk/sport/football\nkgnognmkdheieijnkocmdhgjfgepcdia/index.html",mon:!0,"revisits-checkbox":1,"revisits-number":"1",sat:!1,saved:"true",seconds:"5","start-time":"01:00",sun:!1,thu:!0,tue:!0,wed:!0};o(7294);const c={providers:[],options:e};chrome.runtime.onInstalled.addListener((()=>t.forEach((e=>{chrome.contextMenus.create(e)})))),chrome.contextMenus.onClicked.addListener((async(e,t)=>{const[o,n]=t.url.split("//")??[],l=()=>chrome.tabs.reload(t.id),{addPageToBlockList:c,addDomainToBlockList:d}=(e=>{const t=a(e?.split("/")[0]);return{addPageToBlockList:t=>{r(["providers"],(({providers:o})=>{const r={id:i(),hostname:a(e),isByPath:!0,dateAdded:new Date(Date.now()).toLocaleString()};if(0===o.filter((e=>e.hostname===r.hostname)).length)return s({providers:[...o,r]}),void t();alert("Site is already on block list!")}))},addDomainToBlockList:e=>{r(["providers"],(({providers:o})=>{const a={id:i(),hostname:t,isByPath:!0,dateAdded:new Date(Date.now()).toLocaleString()};if(0===o.filter((e=>e.hostname===a.hostname)).length)return s({providers:[...o,a]}),void e();alert("Site is already on block list!")}))}}})(n);return"addPageToBlockList"===e.menuItemId?(c(l),!0):"addDomainToBlockList"===e.menuItemId?(d(l),!0):"manageBlockList"===e.menuItemId?(chrome.runtime.openOptionsPage(),!0):void 0})),chrome.runtime.onMessage.addListener((({action:e,id:t,log:o},a,i)=>{const l=async()=>{let{providers:e}=await n(["providers"]);const o=e.filter((e=>e.id===t))[0];o&&(e=((e,t,o="id")=>{const a=e.findIndex((e=>e[o]===t[o]));if(a>-1)return e[a]=t,[...e];throw new ReferenceError("No match not found in array.")})(e,{...o,unblocked:!1},"id"),s({providers:e},(()=>{console.log("timeout: Blocking provider (removing unblock)",t,o)})))};if("unblock"===e&&r(["options"],(({options:e})=>{const o=e.allowRevisits.value?6e4*e.revisitLimit.value:1e3;return console.log("unblock listener: Setting unblock timeout for provider",t,"in",o/1e3,"seconds"),setTimeout(l,o),i(!0),!0})),"Enable context menu"===e&&(chrome.contextMenus.update("addPageToBlockList",{visible:!0}),chrome.contextMenus.update("addDomainToBlockList",{visible:!0})),"Disable context menu"===e&&(chrome.contextMenus.update("addPageToBlockList",{visible:!1}),chrome.contextMenus.update("addDomainToBlockList",{visible:!1})),o)return console.log(...Array.isArray(o)?o:[o]),i(!0),!0})),chrome.runtime.onStartup.addListener((()=>{!async function(){let{providers:e}=n(["providers"]);Array.isArray(e)&&(e=e.map((e=>({...e,unblocked:!1}))),s({providers:e},(()=>{})))}()})),async function(t,o){if((t.clearStoredSyncData||t.clearStoredData)&&(await chrome.storage.sync.clear(),console.log("Sync storage was cleared")),(t.clearStoredLocalData||t.clearStoredData)&&(await chrome.storage.local.clear(),console.log("Local storage was cleared")),t.clearStoredMatchData&&await chrome.storage.sync.remove(["providers"]),t.resetOptions&&(await chrome.storage.sync.set({options:e}),console.log("Local storage options were reset")),t.setLegacyData)await chrome.storage.local.set(l),console.log("Local storage was set to legacyData");else{const e=await n(o),t=e=>[e.hostname?.length>3,e.hostname?.includes(".")].every((e=>!0===e));Array.isArray(e.providers)&&(e.providers=e.providers.filter(t).map((e=>({...e,unblocked:!1})))),await s(e),console.log("This object was set in storage:\n",e)}await async function(e){const t=await chrome.storage.local.get(),o=await n(["options","providers"]);if(Object.keys(t).length){console.log("Converting legacy data...");const{"allday-checkbox":a,"revisits-checkbox":r,"revisits-number":n,matches:l,seconds:c,"end-time":d,"start-time":u,mon:p,tue:m,wed:h,thu:v,fri:g,sat:b,sun:y}=t,f=[p,m,h,v,g,b,y];o.options.activeDays.value=o.options.activeDays.value.map(((e,t)=>({...e,value:f[t]??!1}))),o.options.activeTimes.value={allDay:{...o.options.activeTimes.value.allDay,value:a??!0},end:{...o.options.activeTimes.value.end,...d?{value:d}:{}},start:{...o.options.activeTimes.value.start,...u?{value:u}:{}}},o.options.allowRevisits.value=r??!1,o.options.unblockTimeout.value=c??!1,o.options.revisitLimit.value=n??!1,o.options.scheduleBlocking.value=!0;const k=l.split("\n").filter((e=>!e.includes("://"))).filter((e=>e.length>5)).filter((e=>e.includes("."))).map((e=>({hostname:e,id:i(),isByPath:!0,dateAdded:new Date(Date.now()).toLocaleString()})));s({options:{...o.options},providers:k}),e({options:{...o.options},providers:k}),chrome.storage.local.clear()}else console.log("No legacy data was found")}((e=>{console.log("Legacy data was converted to",e)}))}({setLegacyData:!1,clearStoredData:!1,resetOptions:!1,clearStoredSyncData:!1,clearStoredMatchData:!1,clearStoredLocalData:!1},c)})()})();